CREATE TABLE IF NOT EXISTS USERS
(
    ID    BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
    NAME  VARCHAR(255)                            NOT NULL,
    EMAIL VARCHAR(512)                            NOT NULL,
    CONSTRAINT pk_user PRIMARY KEY (ID),
    CONSTRAINT UQ_USER_EMAIL UNIQUE (EMAIL)
);

CREATE TABLE IF NOT EXISTS ITEM_REQUESTS
(
    ID           BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
    DESCRIPTION  VARCHAR(4000)                           NOT NULL,
    REQUESTER_ID BIGINT,
    CREATED      TIMESTAMP WITHOUT TIME ZONE             NOT NULL,
    CONSTRAINT pk_item_request PRIMARY KEY (ID),
    CONSTRAINT FK_ITEM_REQUEST_ON_REQUESTER FOREIGN KEY (REQUESTER_ID) REFERENCES USERS (ID)
);

CREATE TABLE IF NOT EXISTS ITEMS
(
    ID           BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
    NAME         VARCHAR(255)                            NOT NULL,
    DESCRIPTION  VARCHAR(512)                            NOT NULL,
    IS_AVAILABLE BOOLEAN                                 NOT NULL,
    OWNER_ID     INT                                     NOT NULL,
    REQUEST_ID   BIGINT,
    CONSTRAINT pk_item PRIMARY KEY (ID),
    CONSTRAINT FK_ITEM_ON_OWNER FOREIGN KEY (OWNER_ID) REFERENCES USERS (ID),
    CONSTRAINT FK_ITEM_ON_REQUEST FOREIGN KEY (REQUEST_ID) REFERENCES ITEM_REQUESTS (ID)
);

CREATE TABLE IF NOT EXISTS BOOKINGS
(
    ID         BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
    START_DATE TIMESTAMP WITHOUT TIME ZONE             NOT NULL,
    END_DATE   TIMESTAMP WITHOUT TIME ZONE             NOT NULL,
    ITEM_ID    INT                                     NOT NULL,
    BOOKER_ID  INT                                     NOT NULL,
    STATUS     VARCHAR(255)                            NOT NULL,
    CONSTRAINT pk_booking PRIMARY KEY (ID),
    CONSTRAINT FK_BOOKING_ON_ITEM FOREIGN KEY (ITEM_ID) REFERENCES ITEMS (ID),
    CONSTRAINT FK_BOOKING_ON_BOOKER FOREIGN KEY (BOOKER_ID) REFERENCES USERS (ID)
);

CREATE TABLE IF NOT EXISTS COMMENTS
(
    ID        BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
    TEXT      VARCHAR(255)                            NOT NULL,
    ITEM_ID   INT                                     NOT NULL,
    AUTHOR_ID INT                                     NOT NULL,
    CREATED   TIMESTAMP WITHOUT TIME ZONE             NOT NULL,
    CONSTRAINT pk_comment PRIMARY KEY (ID),
    CONSTRAINT FK_COMMENT_ON_AUTHOR FOREIGN KEY (AUTHOR_ID) REFERENCES USERS (ID),
    CONSTRAINT FK_COMMENT_ON_ITEM FOREIGN KEY (ITEM_ID) REFERENCES ITEMS (ID)
);